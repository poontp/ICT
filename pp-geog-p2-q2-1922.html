<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyclone Thermodynamics Diagram</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Animation Utilities */
        .fade-enter { opacity: 0; }
        .fade-enter-active { opacity: 1; transition: opacity 1s; }
        
        /* Heat Pulse Animation for Latent Heat */
        @keyframes heatPulse {
            0% { transform: scale(0.8); opacity: 0.4; box-shadow: 0 0 0 0 rgba(255, 165, 0, 0.7); }
            70% { transform: scale(1.1); opacity: 0.8; box-shadow: 0 0 20px 10px rgba(255, 165, 0, 0); }
            100% { transform: scale(0.8); opacity: 0.4; box-shadow: 0 0 0 0 rgba(255, 165, 0, 0); }
        }
        .heat-pulse { animation: heatPulse 2s infinite; }

        /* Condensation Droplets Animation */
        @keyframes riseAndFade {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { transform: translateY(-60px) scale(1); opacity: 0; }
        }
        .droplet { animation: riseAndFade 2s infinite linear; }

        /* Cloud Growth */
        @keyframes growUp { from { transform: scaleY(0); opacity: 0; } to { transform: scaleY(1); opacity: 1; } }
        .grow-up { animation: growUp 1s ease-out forwards; transform-origin: bottom; }

        /* Dash Offset for moving arrows */
        @keyframes dashMove {
            to { stroke-dashoffset: -20; }
        }
        .animate-dash { animation: dashMove 1s linear infinite; }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons ---
        const ThermometerIcon = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M15 2H9a4 4 0 0 0-4 4v10.54a6 6 0 1 0 12 0V6a4 4 0 0 0-4-4Z"/></svg>
        );

        const CycloneAdvanced = () => {
            const [step, setStep] = useState(0);
            const [isPlaying, setIsPlaying] = useState(false);

            const steps = [
                {
                    id: 0,
                    title: "1. Warm Ocean & Evaporation",
                    description: "The engine begins with warm ocean water (above 26.5°C). Water evaporates, creating a layer of warm, moist air above the surface.",
                },
                {
                    id: 1,
                    title: "2. Convergence & Uplift",
                    description: "Low pressure at the surface causes surrounding air to rush inward (convergence). This warm air is forced to rise.",
                },
                {
                    id: 2,
                    title: "3. Condensation & Latent Heat",
                    description: "CRITICAL STEP: As moist air rises, it cools and condenses into clouds. This phase change releases 'Latent Heat'—hidden energy that warms the surrounding air, making it lighter and causing it to rise even faster.",
                },
                {
                    id: 3,
                    title: "4. Eye Wall Formation",
                    description: "The rapid vertical ascent fueled by latent heat builds towering cumulonimbus clouds. This forms the 'Eye Wall', the most violent part of the storm.",
                },
                {
                    id: 4,
                    title: "5. Divergence & Subsidence (The Cycle)",
                    description: "At the top (tropopause), the air flows outward (divergence). It then cools and sinks (subsidence) far away from the center, completing two massive convection loops.",
                },
            ];

            useEffect(() => {
                let interval;
                if (isPlaying) {
                    interval = setInterval(() => {
                        setStep((prev) => (prev + 1) % steps.length);
                    }, 5000); // Slower timing to read the complex steps
                }
                return () => clearInterval(interval);
            }, [isPlaying]);

            const nextStep = () => setStep((prev) => (prev + 1) % steps.length);
            const prevStep = () => setStep((prev) => (prev === 0 ? steps.length - 1 : prev - 1));

            return (
                <div className="min-h-screen p-2 md:p-6 flex justify-center items-center">
                    <div className="w-full max-w-6xl bg-white rounded-xl shadow-2xl overflow-hidden flex flex-col border border-slate-200">
                        
                        {/* Header */}
                        <div className="bg-slate-900 p-5 text-white flex justify-between items-center">
                            <div>
                                <h1 className="text-xl md:text-2xl font-bold flex items-center gap-3">
                                    <ThermometerIcon />
                                    Thermodynamics of a Cyclone
                                </h1>
                                <p className="text-slate-400 text-sm mt-1">Visualizing Latent Heat & Convection Cycles</p>
                            </div>
                            <div className="text-right hidden md:block">
                                <span className="block text-xs text-slate-500 uppercase">Current Stage</span>
                                <span className="font-mono text-yellow-400 font-bold">{steps[step].title}</span>
                            </div>
                        </div>

                        <div className="flex flex-col lg:flex-row h-full">
                            
                            {/* --- DIAGRAM CANVAS --- */}
                            <div className="w-full lg:w-3/4 bg-sky-50 relative h-[500px] md:h-[600px] overflow-hidden select-none border-b lg:border-b-0 lg:border-r border-slate-200">
                                
                                {/* Background Gradient (Atmosphere) */}
                                <div className="absolute inset-0 bg-gradient-to-b from-blue-200 via-sky-100 to-white opacity-50"></div>

                                {/* 1. Ocean Surface */}
                                <div className="absolute bottom-0 w-full h-20 bg-gradient-to-t from-blue-800 to-blue-600 z-20 flex items-center justify-center border-t border-blue-400 shadow-[0_-5px_15px_rgba(0,0,0,0.1)]">
                                    <div className="text-center">
                                        <span className="text-white font-bold tracking-widest text-sm block">WARM OCEAN (> 26.5°C)</span>
                                        {step >= 0 && <span className="text-blue-200 text-xs animate-pulse">Evaporation occurring</span>}
                                    </div>
                                </div>

                                {/* 2. Low Pressure Label */}
                                {step >= 1 && (
                                    <div className="absolute bottom-24 left-1/2 transform -translate-x-1/2 z-30 flex flex-col items-center">
                                        <div className="bg-red-100 border border-red-300 text-red-800 px-3 py-1 rounded-full text-xs font-bold shadow-sm mb-2">
                                            LOW PRESSURE
                                        </div>
                                    </div>
                                )}

                                {/* 3. The Clouds (Eye Wall) */}
                                {step >= 3 && (
                                    <>
                                        {/* Left Cloud Mass */}
                                        <div className="absolute bottom-20 left-[28%] w-32 h-[400px] z-10 grow-up origin-bottom">
                                            <div className="w-full h-full bg-gradient-to-b from-white via-slate-200 to-slate-400 rounded-t-[50px] opacity-90 relative filter blur-[1px]"></div>
                                            {/* Latent Heat Glows inside Cloud */}
                                            <div className="absolute top-1/2 left-1/2 w-16 h-16 bg-orange-400 rounded-full blur-xl heat-pulse -translate-x-1/2"></div>
                                            <div className="absolute top-1/4 left-1/3 w-10 h-10 bg-yellow-300 rounded-full blur-lg heat-pulse delay-75"></div>
                                        </div>

                                        {/* Right Cloud Mass */}
                                        <div className="absolute bottom-20 right-[28%] w-32 h-[400px] z-10 grow-up origin-bottom">
                                            <div className="w-full h-full bg-gradient-to-b from-white via-slate-200 to-slate-400 rounded-t-[50px] opacity-90 relative filter blur-[1px]"></div>
                                            {/* Latent Heat Glows inside Cloud */}
                                            <div className="absolute top-1/2 right-1/2 w-16 h-16 bg-orange-400 rounded-full blur-xl heat-pulse -translate-x-1/2"></div>
                                            <div className="absolute top-1/3 right-1/4 w-12 h-12 bg-yellow-300 rounded-full blur-lg heat-pulse delay-100"></div>
                                        </div>
                                        
                                        {/* The Eye */}
                                        <div className="absolute top-20 left-1/2 transform -translate-x-1/2 z-10 text-center">
                                            <span className="text-blue-900/50 font-bold tracking-[0.5em] text-sm">EYE</span>
                                        </div>
                                    </>
                                )}

                                {/* 4. Condensation Particles (Step 2+) */}
                                {step >= 2 && (
                                    <div className="absolute inset-0 z-20 pointer-events-none">
                                        {/* Left rising column particles */}
                                        <div className="absolute bottom-24 left-[32%]">
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '0s'}}></div>
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '0.5s', left: '20px'}}></div>
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '1.2s', left: '-10px'}}></div>
                                        </div>
                                        {/* Right rising column particles */}
                                        <div className="absolute bottom-24 right-[32%]">
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '0.2s'}}></div>
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '0.8s', left: '15px'}}></div>
                                            <div className="w-2 h-2 bg-blue-400 rounded-full droplet" style={{animationDelay: '1.5s', left: '-15px'}}></div>
                                        </div>
                                        
                                        {/* Label for Condensation */}
                                        <div className="absolute bottom-48 left-1/2 transform -translate-x-1/2 bg-white/80 px-2 py-1 rounded text-[10px] text-blue-800 font-bold border border-blue-200 shadow-sm">
                                            Condensation
                                        </div>
                                    </div>
                                )}

                                {/* 5. Latent Heat Label (Step 2+) */}
                                {step >= 2 && (
                                    <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-40">
                                        <div className="bg-orange-100/90 border border-orange-400 text-orange-700 px-4 py-2 rounded-lg shadow-lg text-center backdrop-blur-sm">
                                            <div className="text-xs font-bold uppercase">Latent Heat Release</div>
                                            <div className="text-[10px] text-orange-800">Energy powers the storm</div>
                                        </div>
                                    </div>
                                )}

                                {/* --- SVG ARROWS LAYER --- */}
                                <svg className="absolute inset-0 w-full h-full pointer-events-none z-30" viewBox="0 0 800 600">
                                    <defs>
                                        <marker id="arrow-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                            <path d="M0,0 L0,6 L9,3 z" fill="#dc2626" />
                                        </marker>
                                        <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                            <path d="M0,0 L0,6 L9,3 z" fill="#2563eb" />
                                        </marker>
                                    </defs>

                                    {/* Step 1: Inflow */}
                                    {step >= 1 && (
                                        <g>
                                            {/* Left Inflow */}
                                            <path d="M 50 560 L 250 560" stroke="#dc2626" strokeWidth="4" fill="none" markerEnd="url(#arrow-red)" className="animate-dash" strokeDasharray="10,5" />
                                            {/* Right Inflow */}
                                            <path d="M 750 560 L 550 560" stroke="#dc2626" strokeWidth="4" fill="none" markerEnd="url(#arrow-red)" className="animate-dash" strokeDasharray="10,5" />
                                            <text x="150" y="585" textAnchor="middle" fill="#991b1b" fontSize="12" fontWeight="bold">Warm Moist Air</text>
                                            <text x="650" y="585" textAnchor="middle" fill="#991b1b" fontSize="12" fontWeight="bold">Warm Moist Air</text>
                                        </g>
                                    )}

                                    {/* Step 2: Rising (Updraft) */}
                                    {step >= 2 && (
                                        <g>
                                            {/* Left Updraft */}
                                            <path d="M 260 550 Q 300 400 260 150" stroke="#dc2626" strokeWidth="5" fill="none" markerEnd="url(#arrow-red)" strokeDasharray="8,4" className="animate-dash" />
                                            {/* Right Updraft */}
                                            <path d="M 540 550 Q 500 400 540 150" stroke="#dc2626" strokeWidth="5" fill="none" markerEnd="url(#arrow-red)" strokeDasharray="8,4" className="animate-dash" />
                                        </g>
                                    )}

                                    {/* Step 4: Divergence & Subsidence (The Full Cycle) */}
                                    {step >= 4 && (
                                        <g>
                                            {/* LEFT CYCLE */}
                                            {/* Outflow Top Left */}
                                            <path d="M 260 140 Q 200 80 100 80" stroke="#2563eb" strokeWidth="3" fill="none" markerEnd="url(#arrow-blue)" />
                                            {/* Sinking Left */}
                                            <path d="M 80 90 L 80 450" stroke="#2563eb" strokeWidth="3" fill="none" markerEnd="url(#arrow-blue)" strokeDasharray="5,5" />
                                            {/* Return Left */}
                                            <path d="M 80 480 Q 80 540 150 550" stroke="#2563eb" strokeWidth="2" fill="none" markerEnd="url(#arrow-blue)" opacity="0.6" />

                                            {/* RIGHT CYCLE */}
                                            {/* Outflow Top Right */}
                                            <path d="M 540 140 Q 600 80 700 80" stroke="#2563eb" strokeWidth="3" fill="none" markerEnd="url(#arrow-blue)" />
                                            {/* Sinking Right */}
                                            <path d="M 720 90 L 720 450" stroke="#2563eb" strokeWidth="3" fill="none" markerEnd="url(#arrow-blue)" strokeDasharray="5,5" />
                                            {/* Return Right */}
                                            <path d="M 720 480 Q 720 540 650 550" stroke="#2563eb" strokeWidth="2" fill="none" markerEnd="url(#arrow-blue)" opacity="0.6" />

                                            {/* Labels for Subsidence */}
                                            <text x="60" y="300" textAnchor="middle" fill="#1e40af" fontSize="12" fontWeight="bold" transform="rotate(-90 60,300)">Cool Dry Air Sinks</text>
                                            <text x="740" y="300" textAnchor="middle" fill="#1e40af" fontSize="12" fontWeight="bold" transform="rotate(90 740,300)">Cool Dry Air Sinks</text>
                                            
                                            <text x="400" y="60" textAnchor="middle" fill="#1e40af" fontSize="14" fontWeight="bold">Divergence (Outflow)</text>
                                        </g>
                                    )}
                                </svg>
                            </div>

                            {/* --- CONTROLS SIDEBAR --- */}
                            <div className="w-full lg:w-1/4 bg-white p-6 flex flex-col border-l border-slate-100">
                                <div className="flex-1">
                                    <div className="mb-6 flex justify-between items-center">
                                        <div className="text-xs font-bold text-slate-400 uppercase">Step {step + 1} of {steps.length}</div>
                                        <button 
                                            onClick={() => setIsPlaying(!isPlaying)}
                                            className={`text-xs font-bold px-3 py-1 rounded border ${isPlaying ? 'bg-red-50 border-red-200 text-red-600' : 'bg-green-50 border-green-200 text-green-600'}`}
                                        >
                                            {isPlaying ? 'PAUSE' : 'AUTO PLAY'}
                                        </button>
                                    </div>

                                    <h2 className="text-xl font-bold text-slate-800 mb-3">{steps[step].title}</h2>
                                    <p className="text-sm text-slate-600 leading-relaxed mb-6">
                                        {steps[step].description}
                                    </p>

                                    {/* Legend */}
                                    <div className="bg-slate-50 p-4 rounded-lg border border-slate-200">
                                        <h3 className="text-xs font-bold text-slate-500 uppercase mb-3 border-b border-slate-200 pb-2">Diagram Key</h3>
                                        <div className="space-y-3">
                                            <div className="flex items-center gap-2">
                                                <div className="w-4 h-4 bg-orange-400 rounded-full animate-pulse"></div>
                                                <span className="text-xs text-slate-700">Latent Heat Release</span>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <div className="w-6 h-0.5 bg-red-600"></div>
                                                <span className="text-xs text-slate-700">Warm Rising Air</span>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <div className="w-6 h-0.5 bg-blue-600 border-dashed border-t border-blue-600"></div>
                                                <span className="text-xs text-slate-700">Cool Sinking Air</span>
                                            </div>
                                            <div className="flex items-center gap-2">
                                                <div className="w-2 h-2 bg-blue-400 rounded-full"></div>
                                                <span className="text-xs text-slate-700">Condensation</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="mt-6 flex gap-2">
                                    <button onClick={prevStep} className="flex-1 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded text-sm font-semibold">Back</button>
                                    <button onClick={nextStep} className="flex-1 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm font-semibold shadow-lg shadow-blue-200">Next</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CycloneAdvanced />);
    </script>
</body>
</html>